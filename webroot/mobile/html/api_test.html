<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1, user-scalable=0" /><!--设置视窗宽为设备宽度，默认不缩放，不允许用户缩放-->
    <meta name="apple-mobile-web-app-capable" content="yes" /><!--在iOS中 隐藏工具栏和菜单栏-->
    <meta name="format-detection" content="email=no" /><!--忽略电话号码和邮箱识别-->
    <title>TEST API</title>
    <script src="/mobile/js/jsapi.js"></script>
    <script src="/mobile/js/zepto.min.js"></script>
</head>
<body>
<style>

    dl, dt, dd, a, ul, li, ol {
        border: 1px solid #999;
        list-style: outside none none;
        padding: 5px;
    }
</style>

<ul>
    <li onclick="LEMON.db.set('name','kate');"> LEMON.db.set('name','kate')</li>
    <li onclick="alert(LEMON.db.get('name'))">LEMON.db.get('name')</li>
    <li onclick="alert(LEMON.sys.isUseLOC())">LEMON.sys.isUseLOC(),  //是否使用缓存  on  off</li>
    <li onclick="alert(LEMON.sys.version())">LEMON.sys.version() 当前版本号</li>
    <li onclick="alert(LEMON.sys.device())">LEMON.sys.device() 当前设备id</li>
    <li onclick="LEMON.sys.clearWebCatch()">LEMON.sys.clearWebCatch()清除web缓存</li>
    <li onclick="LEMON.sys.QRcode()">LEMON.sys.QRcode()扫二维码</li>
    <li onclick="LEMON.sys.mediaPlay()">LEMON.sys.mediaPlay()开始播放多媒体</li>
    <li onclick="LEMON.login.wx(callback)">LEMON.login.wx(callback)</li>
    <li onclick="LEMON.event.invite('神啊,来下载吧 http://t.cn/RtSw8QS')">LEMON.event.invite('神啊,来下载吧')</li>
    <li onclick="LEMON.pay.wx('order_id', callback)">LEMON.pay.wx('order_id', callback)  微信支付</li>
    <li onclick="LEMON.pay.ali('order_id', callback)">LEMON.pay.ali('order_id', callback)阿里支付</li>
    <li onclick="LEMON.event.getLocation(callback)">LEMON.event.getLocation(callback)</li>
    <li onclick="LEMON.event.getWXCode(callback)">LEMON.event.getWXCode(callback)</li>
    <li onclick="LEMON.event.back()">LEMON.event.back()</li>
    <li onclick="LEMON.event.tel(10086)">LEMON.event.tel(10086)</li>
    <li onclick="LEMON.event.uploadPhoto('\'url_query\':\'?dir=user/avatar&zip=1\'', callback)">LEMON.event.uploadPhoto("'url_query':'?dir=user/avatar&zip=1'}",callback)</li>
    <li onclick="LEMON.event.reuploadPhoto(callback)">LEMON.event.reuploadPhoto(callback)</li>

    <li onclick="LEMON.login.wx(callback)">LEMON.login.wx(callback)  微信登录</li>
    <!--<li onclick="LEMON.login.wx(function(code){alert(12);alert(code);alert('code:'+code)})">LEMON.login.wx(function(code){alert('code:'+code)})  微信登录</li>-->
    <li onclick="LEMON.show.shareIco()">LEMON.show.shareIco()  显示分享图标</li>
    <li onclick="LEMON.sys.back('http://m.chinamatop.com/')">LEMON.sys.back('http://m.chinamatop.com/') 设置点击返回的跳转链接</li>
    <li onclick="LEMON.sys.update('http://m.chinamatop.com/mobile/app/bgq.apk')">LEMON.sys.update('test url') 更新android app</li>
    <li onclick="LEMON.sys.update('https://itunes.apple.com/cn/app/che-jing-ling/id1011007241?mt=8')">LEMON.sys.update('test url') 更新ios app</li>

    <li onclick="LEMON.share.banner()">LEMON.share.banner() 分享条</li>
    <li onclick="LEMON.event.unrefresh()">LEMON.event.unrefresh()关闭本页刷新</li>
    <li onclick="LEMON.sys.openLOC()">LEMON.sys.openLOC()开启缓存</li>
    <li onclick="LEMON.sys.closeLOC()">LEMON.sys.closeLOC()关闭缓存</li>
    <li onclick="LEMON.sys.showKeyboard()">LEMON.sys.showKeyboard()显示键盘 </li>
    <li onclick="LEMON.sys.hideKeyboard()">LEMON.sys.hideKeyboard() 关闭键盘</li>
    <li onclick="LEMON.event.uploadPic(callback)">LEMON.event.uploadPic() 上传单张</li>
    <li onclick="LEMON.event.uploadPics('group')">LEMON.event.uploadPics() 上传多张</li>
    <li onclick="LEMON.event.choosePic('{key:test,max:9}',showPic)">LEMON.event.choosePic() 选择多张图片</li>
    <li onclick="LEMON.event.changePic({index:0, key:'curr_group'},callback)">LEMON.event.changePic()替换单张图 </li>

    <!--
    <li onclick="LEMON.share.QQ(callback)">LEMON.share.QQ(callback) 分享QQ空间</li>
    <li onclick="LEMON.share.QQfriend(callback)">LEMON.share.QQfriend(callback) 分享QQ好友</li>
    <li onclick="LEMON.share.WX(callback)">LEMON.share.WX(callback) 分享微信朋友圈</li>
    <li onclick="LEMON.share.WXfriend(callback)">LEMON.share.WXfriend(callback) 分享微信好友</li>
    <li onclick="LEMON.share.WB(callback)">LEMON.share.WB(callback) 分享微博</li>
    -->

    <li onclick="alert(document.referrer)">document.referrer</li>
    <li><a href="com.chinamatop://main/param?url=http://m.chinamatop.com/activity/index">com.chinamatop://main/param?url=http://m.chinamatop.com/activity/index</a></li>
    <li><a href="./sub_test.html">前往子页面测试</a></li>
</ul>

<br>
</body>
</html>

<script>
    /**

    "hide.share", //隐藏分享图标
            "show.search", //显示搜索
            "share.QQ",
            "share.QQfriend",
            "share.WX",
            "share.WXfriend",
            "env.hasQQ",
            "env.hasWX",
            'login.wx',
            "event.getLocation",
            "event.tel",
            "event.uploadPhoto",
            "event.reuploadPhoto"
    */
    function callback(re){
		alert(re);
    }
    function showPic(re){
        alert('老子是回调函数');
        alert(re);
        re = JSON.parse(re);
        for(k in re.images){
            alert(re.images[k]);
            $('body').append('<img src="'+re.images[k]+'"/>')
        }
    }

    function testset()
    {
        LEMON.db.set('name','kate');
        LEMON.db.set('name2','kate2');
        LEMON.db.set('name3','kate3');
        LEMON.db.set('name4','kate4');
        LEMON.db.set('name5','kate5');
        LEMON.db.set('name6','kate6');
    }






    window.onerror = function (a,b,c,d,e) {
        function f(a) {
            var b, c;
            if ("object" == typeof a) {
                if (null === a)
                    return "null";
                if (window.JSON && window.JSON.stringify)
                    return JSON.stringify(a);
                c = g(a), b = [];
                for (var d in a)
                    b.push(( c ? "" : '"' + d + '":') + f(a[d]));
                return b = b.join(), c ? "[" + b + "]" : "{" + b + "}";
            }
            return "undefined" == typeof a ? "undefined" : "number" == typeof a || "function" == typeof a ? a.toString() : a ? '"' + a + '"' : '""';
        }

        function g(a) {
            return "[object Array]" == Object.prototype.toString.call(a);
        }

        var h, i = window;
        if ( d = d || i.event && i.event.errorCharacter || 0, e && e.stack){
            a = e.stack.toString();
        }
        else if (arguments.callee) {
            for (var j = [a], k = arguments.callee.caller, l = 3; k && --l > 0 && (j.push(k.toString()), k !== k.caller); )
                k = k.caller;
            j = j.join(","), a = j;
        }
        if ( h = f(a) + ( b ? ";URL:" + b : "") + ( c ? ";Line:" + c : "") + ( d ? ";Column:" + d : ""), i._last_err_msg) {
            if (i._last_err_msg.indexOf(a) > -1)
                return;
            i._last_err_msg += "|" + a;
        } else
            i._last_err_msg = a;

        setTimeout(function() {
            console.log("ERROR:" + h);
            alert(h);
            //var a = encodeURIComponent(h), b = new Image;
            //b.src = "//wq.jd.com/webmonitor/collect/badjs.json?Content=" + a + "&t=" + Math.random();
            //当前用户登录ID、时间、手机号码、上报URL
            //b.src = "/BadJS/index.html?Content=" + a + "&t=" + Math.random();

        }, 500);

        return !1
    };

    window.onActiveView = function(){
        alert('pop by onActiveView');
    };
    window.onBackView = function(){
        alert('pop by onBackView');
    };

    window.isAndroid = navigator.userAgent.toLowerCase().indexOf('android') != -1;


//    (function(){
//        var ifr = document.createElement('iframe');
//        ifr.src = '/user/login_status';
//        document.body.appendChild(ifr);
//    })();
</script>



